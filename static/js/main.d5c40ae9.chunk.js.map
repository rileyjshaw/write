{"version":3,"sources":["Loader.js","Workspace.js","getSessionId.js","hello.js","App.js","index.js"],"names":["documents","index","className","map","title","i","key","Workspace","Editors","handleContainerClick","e","focus","this","props","cX","cY","editors","lastFocus","onChange","x","y","editorProps","editorState","onClick","style","left","top","newState","ref","el","Component","adjectives","nouns","getSession","nAdjectives","length","nNouns","initialAdjectiveIdx","Math","floor","random","initialNounIdx","adjectiveOffset","nounOffset","noun","sessionId","window","localStorage","getItem","sessionPrefix","n","hellos","getHello","moveFocusToEnd","EditorState","MODES","Object","freeze","CONTROL","INSERT","LOAD","NOTICES","DELETE","notices","delete","removeItem","state","loadIndex","setState","newDocuments","slice","newLoadIndex","max","min","getEditors","notice","control","App","gridGap","hash","keyStates","mode","showGrid","measure","container","ReactDOM","findDOMNode","Container","clientWidth","clientHeight","rawDraftEditors","JSON","parse","editorRawContent","textAlignment","createWithContent","convertFromRaw","ContentState","createFromText","load","document","split","word","toUpperCase","join","handleHashChange","location","createNewDocument","getSessionId","history","pushState","handleClick","metaKey","pageX","pageY","round","createEmpty","some","getSelection","getHasFocus","handleChange","newEditorState","updatedEditors","filter","getCurrentContent","hasText","stringify","j","convertToRaw","setItem","handleKeyup","handleKeydown","repeat","call","preventDefault","stopPropagation","newIndex","newDocument","console","log","toLowerCase","insert","editor","keys","indexOf","addEventListener","removeEventListener","prevProps","prevState","GridProbe","offsetWidth","documentElement","setProperty","sized","Meta","backgroundSize","lineHeight","Array","fill","render","getElementById"],"mappings":"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","file":"static/js/main.d5c40ae9.chunk.js","sourcesContent":["import React from 'react';\n\nimport './Loader.css';\n\nexport default ({documents, index}) => (\n\t<ul className=\"Loader\">\n\t\t{documents.map((title, i) => (\n\t\t\t<li key={title} className={i === index ? 'highlighted' : ''}>\n\t\t\t\t{title}\n\t\t\t</li>\n\t\t))}\n\t</ul>\n);\n","import {Editor} from 'draft-js';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport './Workspace.css';\n\nclass Workspace extends Component {\n\tEditors = [];\n\n\thandleContainerClick = (e, i) => {\n\t\tthis.Editors[i].focus();\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\tclassName = '',\n\t\t\tcX,\n\t\t\tcY,\n\t\t\teditors,\n\t\t\tlastFocus,\n\t\t\tonChange,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\t<div className={`Workspace ${className}`}>\n\t\t\t\t{editors.map(({x, y, editorProps, editorState}, i) => (\n\t\t\t\t\t/* eslint-disable */\n\t\t\t\t\t/* TODO(riley): Fix a11y issues. */\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={`Workspace-editor${\n\t\t\t\t\t\t\tlastFocus === i ? ' focused' : ''\n\t\t\t\t\t\t}`}\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tonClick={e => this.handleContainerClick(e, i)}\n\t\t\t\t\t\tstyle={{left: cX + x, top: cY + y}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{/* eslint enable */}\n\t\t\t\t\t\t<Editor\n\t\t\t\t\t\t\t{...editorProps}\n\t\t\t\t\t\t\teditorState={editorState}\n\t\t\t\t\t\t\tonChange={newState => onChange(newState, i)}\n\t\t\t\t\t\t\tref={el => (this.Editors[i] = el)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nWorkspace.propTypes = {\n\tclassName: PropTypes.string,\n\teditors: PropTypes.arrayOf(PropTypes.object).isRequired,\n\tonChange: PropTypes.func.isRequired,\n\tlastFocus: PropTypes.number.isRequired,\n};\n\nexport default Workspace;\n","// Returns a calm, memorable session ID that's not already in `localStorage`.\n\nconst adjectives = [\n\t'mossy',\n\t'moonlit',\n\t'foggy',\n\t'distant',\n\t'silent',\n\t'soothing',\n];\n\nconst nouns = ['brook', 'meadow', 'forest', 'plane', 'desert', 'oasis'];\n\nexport default function getSession() {\n\tconst nAdjectives = adjectives.length,\n\t\tnNouns = nouns.length;\n\n\tconst initialAdjectiveIdx = Math.floor(Math.random() * nAdjectives);\n\tconst initialNounIdx = Math.floor(Math.random() * nNouns);\n\n\tfor (\n\t\tlet adjectiveOffset = 0;\n\t\tadjectiveOffset < nAdjectives;\n\t\t++adjectiveOffset\n\t) {\n\t\tfor (let nounOffset = 0; nounOffset < nNouns; ++nounOffset) {\n\t\t\tconst adjectiveIdx =\n\t\t\t\t(initialAdjectiveIdx + adjectiveOffset) % nAdjectives;\n\t\t\tconst nounIdx = (initialNounIdx + nounOffset) % nNouns;\n\t\t\tconst adjective = adjectives[adjectiveIdx];\n\t\t\tconst noun = nouns[nounIdx];\n\t\t\tconst sessionId = `${adjective}-${noun}`;\n\n\t\t\tif (!window.localStorage.getItem(sessionId)) return sessionId;\n\t\t}\n\t}\n\n\t// We've exhausted all possibilities. Now we start into the numbered IDs.\n\tconst sessionPrefix = `${adjectives[initialAdjectiveIdx]}-${nouns[initialNounIdx]}`;\n\tlet sessionId = 0,\n\t\tn = 1;\n\tdo {\n\t\tsessionId = `${sessionPrefix}-${++n}`;\n\t} while (!window.localStorage.getItem(sessionId));\n\n\treturn sessionId;\n}\n","const hellos = ['Hello', 'Ready', 'Go on'];\n\nexport function getHello() {\n\treturn hellos[Math.floor(Math.random() * hellos.length)];\n}\n\nexport default hellos;\n","import {\n\tContentState,\n\tconvertFromRaw,\n\tconvertToRaw,\n\tEditorState,\n} from 'draft-js';\nimport React, {Component} from 'react';\nimport ReactDOM from 'react-dom';\nimport Loader from './Loader';\nimport Workspace from './Workspace';\nimport getSessionId from './getSessionId';\nimport {getHello} from './hello';\n\nimport './App.css';\n\nconst GRID_PROBE_WIDTH = 10000;\nconst {moveFocusToEnd} = EditorState;\nconst MODES = Object.freeze({\n\tCONTROL: 'control',\n\tINSERT: 'insert',\n\tLOAD: 'load',\n});\n// [key, message, callback]\nconst NOTICES = Object.freeze({\n\tDELETE: 'delete',\n\tCONTROL: 'control',\n});\nconst notices = {\n\tdelete: [\n\t\t'Delete? y/N',\n\t\tfunction({key}) {\n\t\t\tswitch (key) {\n\t\t\t\tcase 'y':\n\t\t\t\tcase 'Y':\n\t\t\t\t\tlocalStorage.removeItem(\n\t\t\t\t\t\tthis.state.documents[this.state.loadIndex]\n\t\t\t\t\t);\n\t\t\t\t\tthis.setState(({documents, loadIndex}) => {\n\t\t\t\t\t\tconst newDocuments = [\n\t\t\t\t\t\t\t...documents.slice(0, loadIndex),\n\t\t\t\t\t\t\t...documents.slice(loadIndex + 1),\n\t\t\t\t\t\t];\n\t\t\t\t\t\tconst newLoadIndex = Math.max(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tMath.min(loadIndex, documents.length - 2)\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tdocuments: newDocuments,\n\t\t\t\t\t\t\teditors: this.getEditors(\n\t\t\t\t\t\t\t\tnewDocuments[newLoadIndex]\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnotice: null,\n\t\t\t\t\t\t\tloadIndex: newLoadIndex,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'n':\n\t\t\t\tcase 'N':\n\t\t\t\tcase 'Enter':\n\t\t\t\t\tthis.setState({notice: null});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t],\n\tcontrol: ['Control mode'],\n};\n\nclass App extends Component {\n\tstate = {\n\t\tcX: 0,\n\t\tcY: 0,\n\t\tdocuments: [],\n\t\teditors: [],\n\t\tgridGap: null,\n\t\thash: null,\n\t\tkeyStates: {},\n\t\tlastFocus: 0,\n\t\tloadIndex: 0,\n\t\tmode: MODES.INSERT,\n\t\tnotice: null,\n\t\tshowGrid: false,\n\t};\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('click', this.handleClick);\n\t\twindow.addEventListener('hashchange', this.handleHashChange);\n\t\twindow.addEventListener('resize', this.measure);\n\t\twindow.addEventListener('keydown', this.handleKeydown);\n\t\twindow.addEventListener('keyup', this.handleKeyup);\n\t\tthis.handleHashChange();\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('click', this.handleClick);\n\t\twindow.removeEventListener('hashchange', this.handleHashChange);\n\t\twindow.removeEventListener('resize', this.measure);\n\t\twindow.removeEventListener('keydown', this.handleKeydown);\n\t\twindow.removeEventListener('keyup', this.handleKeyup);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (typeof this.state.gridGap !== 'number' && this.GridProbe) {\n\t\t\tconst gridGap =\n\t\t\t\t(ReactDOM.findDOMNode(this.GridProbe).offsetWidth /\n\t\t\t\t\tGRID_PROBE_WIDTH) *\n\t\t\t\t2;\n\t\t\tdocument.documentElement.style.setProperty(\n\t\t\t\t'--grid-gap',\n\t\t\t\t`${gridGap}px`\n\t\t\t);\n\t\t\tthis.setState({gridGap});\n\t\t} else if (typeof prevState.gridGap !== 'number') {\n\t\t\tthis.measure();\n\t\t}\n\t}\n\n\tmeasure = () => {\n\t\tconst container = ReactDOM.findDOMNode(this.Container);\n\t\tconst cX = container.clientWidth / 2;\n\t\tconst cY = container.clientHeight / 2;\n\n\t\tthis.setState({cX, cY});\n\t};\n\n\t// TODO(riley): Store editors in Dexie or PouchDB.\n\tgetEditors = hash => {\n\t\tconst rawDraftEditors = window.localStorage.getItem(hash);\n\t\treturn rawDraftEditors\n\t\t\t? JSON.parse(rawDraftEditors).map(({x, y, editorRawContent}) => ({\n\t\t\t\t\tx,\n\t\t\t\t\ty,\n\t\t\t\t\teditorProps: {textAlignment: 'center'}, // TODO(riley): Save and restore props.\n\t\t\t\t\teditorState: moveFocusToEnd(\n\t\t\t\t\t\tEditorState.createWithContent(\n\t\t\t\t\t\t\tconvertFromRaw(editorRawContent)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t  }))\n\t\t\t: [\n\t\t\t\t\t{\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\teditorProps: {textAlignment: 'center'},\n\t\t\t\t\t\teditorState: moveFocusToEnd(\n\t\t\t\t\t\t\tEditorState.createWithContent(\n\t\t\t\t\t\t\t\tContentState.createFromText(`${getHello()}.`)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t  ];\n\t};\n\n\tload = hash => {\n\t\tdocument.title =\n\t\t\t'Write | ' +\n\t\t\thash\n\t\t\t\t.split('-')\n\t\t\t\t.map(word => word[0].toUpperCase() + word.slice(1))\n\t\t\t\t.join(' ');\n\n\t\tthis.setState({\n\t\t\thash,\n\t\t\teditors: this.getEditors(hash),\n\t\t\tmode: MODES.INSERT,\n\t\t});\n\t};\n\n\thandleHashChange = () => {\n\t\tlet {hash} = window.location;\n\t\tif (hash) {\n\t\t\tthis.load(hash.slice(1));\n\t\t} else this.createNewDocument();\n\t};\n\n\tcreateNewDocument = () => {\n\t\tconst hash = getSessionId();\n\t\twindow.history.pushState(null, null, `#${hash}`);\n\t\tthis.load(hash);\n\t};\n\n\thandleClick = ({metaKey, pageX, pageY}) => {\n\t\tif (metaKey) {\n\t\t\tthis.setState(({cX, cY, editors, gridGap, lastFocus}) => ({\n\t\t\t\teditors: [\n\t\t\t\t\t...editors,\n\t\t\t\t\t{\n\t\t\t\t\t\t// TODO(riley): Latch to the grid on render, not on construction.\n\t\t\t\t\t\tx: Math.round((pageX - cX) / gridGap) * gridGap,\n\t\t\t\t\t\ty: Math.round((pageY - cY) / gridGap) * gridGap,\n\t\t\t\t\t\teditorProps: {...editors[lastFocus].editorProps},\n\t\t\t\t\t\teditorState: moveFocusToEnd(EditorState.createEmpty()),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tlastFocus: editors.length,\n\t\t\t}));\n\t\t} else if (\n\t\t\t!this.state.editors.some(({editorState}) =>\n\t\t\t\teditorState.getSelection().getHasFocus()\n\t\t\t)\n\t\t) {\n\t\t\tconst {Container: {Editors = []} = {}} = this;\n\t\t\tif (Editors.length) Editors[0].focus();\n\t\t}\n\t};\n\n\thandleChange = (newEditorState, i) => {\n\t\tconst {hash, editors, lastFocus} = this.state;\n\n\t\t// Update the focused Editor and remove any empty, unfocused ones.\n\t\tconst updatedEditors = [\n\t\t\t...editors.slice(0, i),\n\t\t\t{...editors[i], editorState: newEditorState},\n\t\t\t...editors.slice(i + 1),\n\t\t].filter(\n\t\t\t({editorState}) =>\n\t\t\t\teditorState.getSelection().getHasFocus() ||\n\t\t\t\teditorState.getCurrentContent().hasText() ||\n\t\t\t\tlastFocus === i\n\t\t);\n\n\t\t// Persist the current state to localStorage and state.\n\t\tconst rawDraftEditors = JSON.stringify(\n\t\t\tupdatedEditors.map(({x, y, editorState}, j) => ({\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\teditorRawContent: convertToRaw(\n\t\t\t\t\t(i === j\n\t\t\t\t\t\t? newEditorState\n\t\t\t\t\t\t: editorState\n\t\t\t\t\t).getCurrentContent()\n\t\t\t\t),\n\t\t\t}))\n\t\t);\n\t\twindow.localStorage.setItem(hash, rawDraftEditors);\n\t\tthis.setState({editors: updatedEditors, lastFocus: i});\n\t};\n\n\thandleKeyup = e => {\n\t\tconst {key} = e;\n\t\tthis.setState({\n\t\t\tkeyStates: {\n\t\t\t\t...this.state.keyStates,\n\t\t\t\t[key]: false,\n\t\t\t},\n\t\t});\n\t};\n\n\thandleKeydown = e => {\n\t\tconst {key, metaKey, repeat} = e;\n\t\tif (repeat) return;\n\t\tconst {documents, keyStates, loadIndex, mode, notice} = this.state;\n\n\t\tthis.setState({\n\t\t\tkeyStates: {\n\t\t\t\t...keyStates,\n\t\t\t\t[key]: true,\n\t\t\t},\n\t\t});\n\n\t\tif (notice && notices[notice][1]) {\n\t\t\tnotices[notice][1].call(this, e);\n\t\t\tif (!metaKey) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t} else if (mode === MODES.LOAD) {\n\t\t\tswitch (key) {\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tthis.setState(({documents, loadIndex}) => {\n\t\t\t\t\t\tconst newIndex =\n\t\t\t\t\t\t\t(documents.length + loadIndex - 1) %\n\t\t\t\t\t\t\tdocuments.length;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tloadIndex: newIndex,\n\t\t\t\t\t\t\teditors: this.getEditors(documents[newIndex]),\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tthis.setState(({documents, loadIndex}) => {\n\t\t\t\t\t\tconst newIndex = (loadIndex + 1) % documents.length;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tloadIndex: newIndex,\n\t\t\t\t\t\t\teditors: this.getEditors(documents[newIndex]),\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Enter':\n\t\t\t\t\tconst newDocument = documents[loadIndex];\n\t\t\t\t\twindow.history.pushState(null, null, `#${newDocument}`);\n\t\t\t\t\tthis.load(newDocument);\n\t\t\t\t\tthis.setState({mode: MODES.INSERT});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\t// Stub: Navigate document history.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'c':\n\t\t\t\tcase 'C':\n\t\t\t\t\t// Stub: Duplicate.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'd':\n\t\t\t\tcase 'D':\n\t\t\t\t\tthis.setState({notice: NOTICES.DELETE});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'r':\n\t\t\t\tcase 'R':\n\t\t\t\t\t// Stub: Rename.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'q':\n\t\t\t\tcase 'Q':\n\t\t\t\t\tthis.setState({mode: MODES.INSERT});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!metaKey) {\n\t\t\t\tconsole.log(`Prevented a ${key}`);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t} else if (mode === MODES.CONTROL && !metaKey) {\n\t\t\tswitch (key) {\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\tthis.setState(({editors, lastFocus}) => {\n\t\t\t\t\t\tconst editor = editors[lastFocus];\n\t\t\t\t\t\tconst updatedEditors = [\n\t\t\t\t\t\t\t...editors.slice(0, lastFocus),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t...editor,\n\t\t\t\t\t\t\t\teditorProps: {\n\t\t\t\t\t\t\t\t\t...editor.editorProps,\n\t\t\t\t\t\t\t\t\ttextAlignment:\n\t\t\t\t\t\t\t\t\t\teditor.editorProps.textAlignment ===\n\t\t\t\t\t\t\t\t\t\t'right'\n\t\t\t\t\t\t\t\t\t\t\t? 'center'\n\t\t\t\t\t\t\t\t\t\t\t: 'left',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...editors.slice(lastFocus + 1),\n\t\t\t\t\t\t];\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\teditors: updatedEditors,\n\t\t\t\t\t\t\tmode: MODES.INSERT,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\tthis.setState(({editors, lastFocus}) => {\n\t\t\t\t\t\tconst editor = editors[lastFocus];\n\t\t\t\t\t\tconst updatedEditors = [\n\t\t\t\t\t\t\t...editors.slice(0, lastFocus),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t...editor,\n\t\t\t\t\t\t\t\teditorProps: {\n\t\t\t\t\t\t\t\t\t...editor.editorProps,\n\t\t\t\t\t\t\t\t\ttextAlignment:\n\t\t\t\t\t\t\t\t\t\teditor.editorProps.textAlignment ===\n\t\t\t\t\t\t\t\t\t\t'left'\n\t\t\t\t\t\t\t\t\t\t\t? 'center'\n\t\t\t\t\t\t\t\t\t\t\t: 'right',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...editors.slice(lastFocus + 1),\n\t\t\t\t\t\t];\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\teditors: updatedEditors,\n\t\t\t\t\t\t\tmode: MODES.INSERT,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'g':\n\t\t\t\tcase 'G':\n\t\t\t\t\tthis.setState(({showGrid}) => ({\n\t\t\t\t\t\tmode: MODES.INSERT,\n\t\t\t\t\t\tshowGrid: !showGrid,\n\t\t\t\t\t}));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'n':\n\t\t\t\tcase 'N':\n\t\t\t\t\tthis.createNewDocument();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'o':\n\t\t\t\tcase 'O':\n\t\t\t\t\tthis.setState(() => {\n\t\t\t\t\t\tconst documents = Object.keys(localStorage);\n\t\t\t\t\t\tconst hash =\n\t\t\t\t\t\t\twindow.location.hash &&\n\t\t\t\t\t\t\twindow.location.hash.slice(1);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tdocuments,\n\t\t\t\t\t\t\tloadIndex: Math.max(0, documents.indexOf(hash)),\n\t\t\t\t\t\t\tmode: MODES.LOAD,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.setState({mode: MODES.INSERT});\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t} else if (metaKey && key.toLowerCase() === 'e') {\n\t\t\t// If it's in insert or control mode, toggle to the other one. Otherwise, don't change the mode.\n\t\t\tthis.setState(({mode}) => ({\n\t\t\t\tmode:\n\t\t\t\t\t{insert: MODES.CONTROL, control: MODES.INSERT}[mode] ||\n\t\t\t\t\tmode,\n\t\t\t}));\n\t\t}\n\t};\n\n\trender() {\n\t\tconst {\n\t\t\tcX,\n\t\t\tcY,\n\t\t\tdocuments,\n\t\t\teditors,\n\t\t\tgridGap,\n\t\t\thash,\n\t\t\tkeyStates,\n\t\t\tlastFocus,\n\t\t\tloadIndex,\n\t\t\tmode,\n\t\t\tnotice,\n\t\t\tshowGrid,\n\t\t} = this.state;\n\n\t\tconst sized = typeof gridGap === 'number';\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={`App${\n\t\t\t\t\tsized && (showGrid || mode === 'control' || keyStates.Meta)\n\t\t\t\t\t\t? ' show-grid'\n\t\t\t\t\t\t: ''\n\t\t\t\t} control-mode-${mode === 'control' ? 'on' : 'off'}`}\n\t\t\t\tstyle={\n\t\t\t\t\tsized\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tbackgroundSize: `${gridGap}px ${gridGap}px`,\n\t\t\t\t\t\t\t\tlineHeight: `${gridGap}px`,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {}\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{hash &&\n\t\t\t\t\t(sized ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{mode === MODES.LOAD && (\n\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\tdocuments={documents}\n\t\t\t\t\t\t\t\t\tindex={loadIndex}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{notice && (\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t<strong className=\"App-notice\">\n\t\t\t\t\t\t\t\t\t\t{notices[notice][0]}\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Workspace\n\t\t\t\t\t\t\t\tcX={cX}\n\t\t\t\t\t\t\t\tcY={cY}\n\t\t\t\t\t\t\t\teditors={editors}\n\t\t\t\t\t\t\t\tlastFocus={lastFocus}\n\t\t\t\t\t\t\t\tonChange={this.handleChange}\n\t\t\t\t\t\t\t\tref={el => (this.Container = el)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName=\"Grid-probe\"\n\t\t\t\t\t\t\tref={el => (this.GridProbe = el)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{new Array(GRID_PROBE_WIDTH).fill('0').join('')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}