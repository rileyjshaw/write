(this.webpackJsonpwrite=this.webpackJsonpwrite||[]).push([[0],{186:function(t,e,n){},187:function(t,e,n){},188:function(t,e,n){"use strict";n.r(e);var o=n(3),r=n.n(o),a=n(13),i=n.n(a),c=n(20),s=n(15),d=n(36),l=n(37),u=n(40),h=n(39),f=n(38),m=n(41),p=n(10),v=(n(186),function(t){function e(){var t,n;Object(d.a)(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=Object(u.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(r)))).Editors=[],n.handleContainerClick=function(t,e){n.Editors[e].focus()},n}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.className,o=void 0===n?"":n,a=e.cX,i=e.cY,c=e.editors,s=e.lastFocus,d=e.onChange;return r.a.createElement("div",{className:"App ".concat(o)},c.map((function(e,n){var o=e.x,c=e.y,l=e.editorProps,u=e.editorState;return r.a.createElement("div",{className:"App-editor".concat(s===n?" focused":""),key:n,onClick:function(e){return t.handleContainerClick(e,n)},style:{left:a+o,top:i+c}},r.a.createElement(p.Editor,Object.assign({},l,{editorState:u,onChange:function(t){return d(t,n)},ref:function(e){return t.Editors[n]=e}})))})))}}]),e}(o.Component)),w=["mossy","moonlit","foggy","distant","silent","soothing"],g=["brook","meadow","forest","plane","desert","oasis"];function y(){for(var t=w.length,e=g.length,n=Math.floor(Math.random()*t),o=Math.floor(Math.random()*e),r=0;r<t;++r)for(var a=0;a<e;++a){var i=g[(o+a)%e],c="".concat(w[(n+r)%t],"-").concat(i);if(!window.localStorage.getItem(c))return c}var s="".concat(w[n],"-").concat(g[o]),d=0,l=1;do{d="".concat(s,"-").concat(++l)}while(!window.localStorage.getItem(d));return d}var b=["Hello","Ready","Go on"];function S(){return b[Math.floor(Math.random()*b.length)]}var O=p.EditorState.moveFocusToEnd,j=function(t){function e(){var t,n;Object(d.a)(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=Object(u.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(r)))).state={cX:0,cY:0,gridX:null,hash:null,editors:[],lastFocus:0,controlMode:!1},n.measure=function(){var t=i.a.findDOMNode(n.Container),e=t.clientWidth/2,o=t.clientHeight/2;n.setState({cX:e,cY:o})},n.load=function(){var t=window.location.hash;t?t=t.slice(1):(t=y(),window.history.pushState(null,null,"#".concat(t))),document.title="Write | "+t.split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join(" ");var e=window.localStorage.getItem(t),o=e?JSON.parse(e).map((function(t){var e=t.x,n=t.y,o=t.editorRawContent;return{x:e,y:n,editorProps:{textAlignment:"center"},editorState:O(p.EditorState.createWithContent(Object(p.convertFromRaw)(o)))}})):[{x:0,y:0,editorProps:{textAlignment:"center"},editorState:O(p.EditorState.createWithContent(p.ContentState.createFromText("".concat(S(),"."))))}];n.setState({hash:t,editors:o})},n.handleClick=function(t){var e=t.metaKey,o=t.pageX,r=t.pageY;if(e)n.setState((function(t){var e=t.cX,n=t.cY,a=t.editors,i=t.lastFocus;return{editors:[].concat(Object(s.a)(a),[{x:13*Math.round((o-e)/13)-2,y:18*Math.round((r-n)/18),editorProps:Object(c.a)({},a[i].editorProps),editorState:O(p.EditorState.createEmpty())}]),lastFocus:a.length}}));else if(!n.state.editors.some((function(t){return t.editorState.getSelection().getHasFocus()}))){var a=Object(f.a)(n).Container,i=(a=void 0===a?{}:a).Editors,d=void 0===i?[]:i;d.length&&d[0].focus()}},n.handleChange=function(t,e){var o=n.state,r=o.hash,a=o.editors,i=o.lastFocus,d=[].concat(Object(s.a)(a.slice(0,e)),[Object(c.a)({},a[e],{editorState:t})],Object(s.a)(a.slice(e+1))).filter((function(t){var n=t.editorState;return n.getSelection().getHasFocus()||n.getCurrentContent().hasText()||i===e})),l=JSON.stringify(d.map((function(n,o){var r=n.x,a=n.y,i=n.editorState;return{x:r,y:a,editorRawContent:Object(p.convertToRaw)((e===o?t:i).getCurrentContent())}})));window.localStorage.setItem(r,l),n.setState({editors:d,lastFocus:e})},n.handleKeydown=function(t){var e=t.key,o=t.metaKey;if(n.state.controlMode&&!o){switch(e){case"ArrowLeft":n.setState((function(t){var e=t.editors,n=t.lastFocus,o=e[n];return{editors:[].concat(Object(s.a)(e.slice(0,n)),[Object(c.a)({},o,{editorProps:Object(c.a)({},o.editorProps,{textAlignment:"right"===o.editorProps.textAlignment?"center":"left"})})],Object(s.a)(e.slice(n+1)))}}));break;case"ArrowRight":n.setState((function(t){var e=t.editors,n=t.lastFocus,o=e[n];return{editors:[].concat(Object(s.a)(e.slice(0,n)),[Object(c.a)({},o,{editorProps:Object(c.a)({},o.editorProps,{textAlignment:"left"===o.editorProps.textAlignment?"center":"right"})})],Object(s.a)(e.slice(n+1)))}}))}n.setState({controlMode:!1}),t.preventDefault(),t.stopPropagation()}else o&&"e"===e.toLowerCase()&&n.setState((function(t){return{controlMode:!t.controlMode}}))},n}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.handleClick),window.addEventListener("hashchange",this.load),window.addEventListener("resize",this.measure),window.addEventListener("keydown",this.handleKeydown),window.addEventListener("keyup",this.handleKeyup),this.load()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick),window.removeEventListener("hashchange",this.load),window.removeEventListener("resize",this.measure),window.removeEventListener("keydown",this.handleKeydown),window.removeEventListener("keyup",this.handleKeyup)}},{key:"componentDidUpdate",value:function(t,e){"number"!==typeof this.state.gridX&&this.GridProbe?this.setState({gridX:i.a.findDOMNode(this.GridProbe).offsetWidth/1e3}):"number"!==typeof e.gridX&&this.measure()}},{key:"render",value:function(){var t=this,e=this.state,n=e.controlMode,o=e.cX,a=e.cY,i=e.editors,c=e.gridX,s=e.hash,d=e.lastFocus;return s&&("number"===typeof c?r.a.createElement(v,{className:"control-mode-".concat(n?"on":"off"),cX:o,cY:a,editors:i,lastFocus:d,onChange:this.handleChange,ref:function(e){return t.Container=e}}):r.a.createElement("span",{className:"Grid-probe",ref:function(e){return t.GridProbe=e}},new Array(1e3).fill(".").join("")))}}]),e}(o.Component);n(187);i.a.render(r.a.createElement(j,null),document.getElementById("root"))},88:function(t,e,n){t.exports=n(188)}},[[88,1,2]]]);
//# sourceMappingURL=main.a88bb746.chunk.js.map